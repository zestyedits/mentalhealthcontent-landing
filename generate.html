<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generate — MentalHealthContent.ai</title>
  <meta name="description" content="Generate client-friendly mental-health content with AI. Export text or DOCX.">

  <style>
    :root {
      --bg: #0b1022;
      --panel: #0e1436;
      --muted: #c7d2fe;
      --text: #eef2ff;
      --accent: #8b5cf6;
      --accent-2: #06b6d4;
      --card: #0a0f2b;
      --border: #1b2161;
      --ring: rgba(139,92,246,.35);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial; color: var(--text); }
    body {
      background: radial-gradient(1000px 600px at 10% -10%, color-mix(in oklab, var(--accent) 40%, transparent), transparent 60%),
                  radial-gradient(900px 500px at 90% 10%, color-mix(in oklab, var(--accent-2) 40%, transparent), transparent 60%),
                  linear-gradient(180deg, var(--bg), #0b0f24 50%, var(--panel) 120%);
    }
    .container { max-width:1100px; margin:0 auto; padding:0 1rem; }
    header { position:sticky; top:0; z-index:50; backdrop-filter:blur(8px); background:rgba(11,18,32,.7); border-bottom:1px solid var(--border);}
    .nav { display:flex; justify-content:space-between; align-items:center; padding:.9rem 0; }
    .brand { display:flex; gap:.6rem; align-items:center; font-weight:700; }
    .menu { display:flex; gap:1rem; }
    .menu a { color:var(--text); opacity:.9; font-size:.95rem; }
    .btn { display:inline-flex; align-items:center; justify-content:center; padding:.65rem .95rem; border-radius:.75rem; border:1px solid var(--border); background:#101826; color:var(--text); font-weight:600; cursor:pointer; }
    .btn.primary { background:linear-gradient(135deg,var(--accent),var(--accent-2)); border:0; color:#0a0a0a; }
    .hero { padding:2.5rem 0 1.25rem; }
    .hero h1 { font-size:2.2rem; background:linear-gradient(90deg,var(--accent),var(--accent-2)); -webkit-background-clip:text; background-clip:text; color:transparent; margin:.5rem 0; }
    .meta { color:var(--muted); font-size:.95rem; }
    .pill { background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#0a0a0a; border-radius:999px; padding:.25rem .6rem; font-size:.75rem; margin-left:.5rem; }
    .studio { display:grid; gap:1rem; margin:1rem 0 2rem; }
    @media(min-width:980px){.studio{grid-template-columns:390px 1fr;}}
    .card { background:var(--card); border:1px solid var(--border); border-radius:1rem; padding:1rem; }
    label{font-weight:600; display:block; margin:.5rem 0;}
    input,select{width:100%; padding:.7rem .85rem; background:#0c1424; border:1px solid var(--border); border-radius:.7rem; color:var(--text);}
    .actions{display:flex;gap:.6rem;align-items:center;flex-wrap:wrap;}
    .out{background:#0c1424; border:1px solid var(--border); border-radius:.7rem; padding:.9rem; max-height:60vh; overflow:auto;}
    pre{white-space:pre-wrap; word-break:break-word; font-family:monospace; font-size:.95rem; margin:0;}
    footer{border-top:1px solid var(--border); padding:2rem 0; color:var(--muted); font-size:.9rem;}
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.3.2/docx.umd.min.js" defer></script>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <svg viewBox="0 0 24 24" width="28" height="28"><path d="M12 21s-6-3.8-9-7.1C1 12 1 9.5 2.7 7.8c1.6-1.6 4.3-1.5 6 0L12 9l3.3-1.2c1.7-1.5 4.4-1.6 6 0C22 9.5 22 12 21 13.9 18 17.2 12 21 12 21z" fill="url(#g)"/></svg>
        <span>MentalHealthContent.ai</span>
      </div>
      <nav class="menu">
        <a href="/#examples">Examples</a>
        <a href="/#prompts">Free Prompts</a>
        <a href="/#pricing">Pricing</a>
        <a href="/#faq">FAQ</a>
        <a class="btn ghost" href="https://app.mentalhealthcontent.ai">Sign in</a>
        <a class="btn primary" href="/#start">Start free</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Generate client-friendly content</h1>
      <p class="meta">Start with a topic and format. Export as text or DOCX. <em>Educational use only.</em>
        <span id="creditPill" class="pill">Free credits left: 2</span>
      </p>
    </section>

    <section class="studio">
      <div class="card rail">
        <h3>Your request</h3>
        <form id="genForm">
          <label for="topic">Topic</label>
          <input id="topic" value="DBT Skills for Teens">
          <label for="format">Format</label>
          <select id="format">
            <option value="carousel">Instagram carousel</option>
            <option value="worksheet" selected>Worksheet outline</option>
            <option value="video">60s video script</option>
            <option value="blog">Blog outline</option>
          </select>
          <div class="actions" style="margin-top:.8rem">
            <button class="btn primary" type="submit" id="btnGenerate">Generate</button>
            <button class="btn" type="button" id="btnSample">Use sample</button>
            <span id="status" style="margin-left:auto;color:var(--muted);font-size:.9rem;"></span>
          </div>
        </form>
        <hr style="margin:1rem 0; border:none; border-top:1px solid var(--border)">
        <div class="actions">
          <button class="btn" id="btnDocx" title="Sign in to export DOCX" disabled>Generate & Download DOCX</button>
          <button class="btn" id="btnCopy" disabled>Copy output</button>
        </div>
      </div>
      <div class="card canvas">
        <h3>Output</h3>
        <div class="out"><pre id="out">Run a generation to see output…</pre></div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">MentalHealthContent.ai • © <span id="yr"></span></div>
  </footer>

  <script>
    document.getElementById('yr').textContent = new Date().getFullYear();

    const TRIAL_KEY = 'mhc_trial_uses_v1';
    const MAX_FREE = 2;
    function getTrialUses(){ return +localStorage.getItem(TRIAL_KEY)||0; }
    function incTrialUses(){ localStorage.setItem(TRIAL_KEY,getTrialUses()+1); }
    function remainingFree(){ return Math.max(0,MAX_FREE-getTrialUses()); }
    function updateCreditPill(){document.getElementById('creditPill').textContent=`Free credits left: ${remainingFree()}`;}
    updateCreditPill();

    const form=document.getElementById('genForm'),topic=document.getElementById('topic'),formatSel=document.getElementById('format');
    const out=document.getElementById('out'),copyBtn=document.getElementById('btnCopy'),statusEl=document.getElementById('status');
    const genBtn=document.getElementById('btnGenerate'),docxBtn=document.getElementById('btnDocx');

    function setOut(txt){out.textContent=txt;copyBtn.disabled=!txt.trim();}
    async function runGeneration(payload){
      if(remainingFree()===0){genBtn.disabled=true;genBtn.textContent='Create account to continue';return;}
      statusEl.textContent="Generating…"; setOut("");
      try{
        const res=await fetch('/api/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
        const data=await res.json(); const text=data.output||'No output'; setOut(text);
        incTrialUses(); updateCreditPill(); if(remainingFree()===0){genBtn.disabled=true;genBtn.textContent='Create account to continue';}
      }catch(e){setOut('Error: '+e.message);}finally{statusEl.textContent="";}
    }
    form.addEventListener('submit',e=>{e.preventDefault();runGeneration({topic:topic.value.trim(),format:formatSel.value});});
    document.getElementById('btnSample').onclick=()=>{topic.value="5-4-3-2-1 grounding for teens";formatSel.value="carousel";};
    copyBtn.onclick=()=>navigator.clipboard.writeText(out.textContent||"");
  </script>
</body>
</html>
